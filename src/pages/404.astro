---
import Base from "../layouts/Base.astro";
import LatestPosts from "../components/features/projects/LatestPosts.astro";
import { Icon } from "astro-icon/components";
---

<Base postData={{ data: { title: "Page introuvable" } }} noindex={true}>
  <section
    class="container mx-auto px-7 py-24 flex flex-col items-center justify-center min-h-[50vh] text-center"
  >
    <div class="relative mb-10">
      <div
        class="text-[150px] md:text-[200px] font-pacamara-space font-bold text-pacamara-secondary/10 dark:text-pacamara-accent/10 leading-none select-none"
        aria-hidden="true"
      >
        404
      </div>
      <div class="absolute inset-0 flex items-center justify-center">
        <h1
          class="text-4xl md:text-5xl font-pacamara-space font-bold text-pacamara-dark dark:text-white"
        >
          Oups !
        </h1>
      </div>
    </div>

    <p
      class="text-xl md:text-2xl font-outfit text-pacamara-primary/80 dark:text-white/80 max-w-2xl mb-10"
    >
      Il semblerait que vous ayez tourn√© la mauvaise page du sc√©nario. Cette
      sc√®ne a √©t√© coup√©e au montage.
    </p>

    <div class="flex flex-wrap items-center justify-center gap-4">
      <a
        href="/"
        aria-label="Retour √† l'accueil"
        class="group inline-flex items-center gap-2 bg-pacamara-secondary text-white font-bold py-3 px-8 rounded-full shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 cursor-pointer focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-pacamara-accent focus-visible:ring-offset-2"
      >
        <Icon
          name="mdi:home"
          class="w-5 h-5 transition-transform duration-300 group-hover:-translate-y-1"
        />
        <span>Retour √† l'accueil</span>
      </a>
      <button
        id="go-back-btn"
        class="group inline-flex items-center gap-2 bg-transparent border-2 border-pacamara-secondary text-pacamara-secondary dark:text-white font-bold py-3 px-8 rounded-full hover:bg-pacamara-secondary/10 transition-all duration-300 cursor-pointer focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-pacamara-accent focus-visible:ring-offset-2"
        aria-label="Retourner √† la page pr√©c√©dente"
      >
        <Icon
          name="mdi:arrow-left"
          class="w-5 h-5 transition-transform duration-300 group-hover:-translate-x-1"
        />
        <span>Page pr√©c√©dente</span>
      </button>
    </div>
  </section>

  <!-- Suggest recent projects to keep user engaged -->
  <div class="border-t border-pacamara-secondary/10">
    <LatestPosts
      postLimit={3}
      title="Plut√¥t int√©ress√© par..."
      subtitle="Voici quelques projets qui pourraient vous plaire au lieu de cette page vide."
      lazyLoadImages={true}
    />
  </div>
</Base>
<script>
  /**
   * üõ°Ô∏è Sentinel: CSP Compliance
   * Replaced inline `onclick` with event listener to support `script-src-attr 'none'`.
   */
  function initBackBtn() {
    const btn = document.getElementById("go-back-btn");
    // Guard: Check if button exists and hasn't been initialized yet
    // Note: View Transitions might replace the body, so we always re-bind if found.
    // But to be safe against double-binding on the same element instance:
    if (!btn || btn.dataset.initialized === "true") return;

    // üé® Palette: Hide button if no history exists to prevent dead clicks
    if (window.history.length <= 1) {
      btn.classList.add("hidden");
      return;
    }

    btn.dataset.initialized = "true";
    btn.addEventListener("click", () => {
      history.back();
    });
  }

  // Initialize on load and after navigation (View Transitions)
  initBackBtn();
  document.addEventListener("astro:page-load", initBackBtn);
</script>

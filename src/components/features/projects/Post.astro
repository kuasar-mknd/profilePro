---
const { postData, num, bentoSize = "" } = Astro.props;
import { Image, Picture } from "astro:assets";
import PublishDate from "./PublishDate.astro";
import Tag from "../../ui/Tag.astro";

const isLarge = bentoSize === "bento-item-large";
const isWide = bentoSize === "bento-item-wide";
---

<article
  class:list={[
    "group relative h-full rounded-2xl overflow-hidden shadow-lg card-glow transition-all duration-500",
    isLarge ? "min-h-[400px] md:min-h-[500px]" : "min-h-[280px]",
    isWide ? "min-h-[280px]" : "",
  ]}
>
  <a
    href={`/project/${postData.slug}`}
    aria-label={`Voir le projet ${postData.data.title}`}
    class="block h-full"
  >
    <!-- Background Image with zoom effect -->
    <div class="absolute inset-0 image-zoom">
      <Picture
        src={postData.data.image}
        widths={[400, 800, 1200]}
        sizes={isLarge
          ? "(max-width: 768px) 100vw, 50vw"
          : "(max-width: 768px) 100vw, 25vw"}
        formats={["avif", "webp"]}
        fallbackFormat="avif"
        alt={postData.data.title}
        width={isLarge ? 800 : 400}
        height={isLarge ? 600 : 300}
        class="w-full h-full object-cover"
        transition:name={`project-image-${postData.slug}`}
      />
    </div>

    <!-- Gradient Overlay -->
    <div
      class="absolute inset-0 bg-linear-to-t from-black/80 via-black/30 to-transparent opacity-70 group-hover:opacity-90 transition-opacity duration-500"
    >
    </div>

    <!-- Content Overlay -->
    <div class="absolute inset-0 flex flex-col justify-end p-6 md:p-8">
      <!-- Tags -->
      <div
        class="flex flex-wrap gap-2 mb-3 transform translate-y-4 opacity-0 group-hover:translate-y-0 group-hover:opacity-100 transition-all duration-500"
      >
        <Tag tag={postData.data.tag} />
      </div>

      <!-- Title -->
      <h3
        class:list={[
          "font-pacamara-space font-bold text-white mb-2 transition-all duration-300 group-hover:text-pacamara-accent",
          isLarge ? "text-2xl md:text-4xl" : "text-xl md:text-2xl",
        ]}
      >
        {postData.data.title}
      </h3>

      <!-- Description - shows on hover for smaller cards, always visible for large -->
      <p
        class:list={[
          "font-outfit text-white/80 line-clamp-2 transition-all duration-500",
          isLarge
            ? "text-base md:text-lg opacity-100"
            : "text-sm opacity-0 group-hover:opacity-100 translate-y-4 group-hover:translate-y-0",
        ]}
      >
        {postData.data.intro}
      </p>

      <!-- Date -->
      <div class="mt-4 flex items-center gap-4 text-white/60 text-sm">
        <PublishDate date={postData.data.pubDate} />
      </div>
    </div>

    <!-- Hover border effect -->
    <div
      class="absolute inset-0 border-2 border-transparent group-hover:border-pacamara-accent/50 rounded-2xl transition-colors duration-500 pointer-events-none"
    >
    </div>
  </a>
</article>

---
// src/components/ImageGallery.astro
import { Image, Picture } from "astro:assets";

// Dossier spÃ©cifique pour charger les images
const { folder } = Astro.props;
let images = {};

// Utiliser import.meta.glob pour charger les images statiquement
if (folder === "lola-clip") {
  images = import.meta.glob(
    "../../assets/lola-clip/*.{avif,png,jpg,jpeg,svg,JPEG}",
  );
} else if (folder == "proud-rebel") {
  images = import.meta.glob(
    "../../assets/proud-rebel/*.{avif,png,jpg,jpeg,svg,JPEG}",
  );
} else if (folder == "bcp") {
  images = import.meta.glob("../../assets/bcp/*.{avif,png,jpg,jpeg,svg,JPEG}");
} else if (folder == "xxcent-sourire") {
  images = import.meta.glob(
    "../../assets/xxcent-sourire/*.{avif,png,jpg,jpeg,svg,JPEG}",
  );
} else if (folder == "larev") {
  images = import.meta.glob(
    "../../assets/larev/*.{avif,png,jpg,jpeg,svg,JPEG}",
  );
} else if (folder == "izia-fete-musique") {
  images = import.meta.glob(
    "../../assets/izia-fete-musique/*.{avif,png,jpg,jpeg,svg,JPEG}",
  );
} else if (folder == "cactus-heart") {
  images = import.meta.glob(
    "../../assets/cactus-heart/*.{avif,png,jpg,jpeg,svg,JPEG}",
  );
} else if (folder == "48h-lausanne") {
  images = import.meta.glob(
    "../../assets/48h-lausanne/*.{avif,png,jpg,jpeg,svg,JPEG}",
  );
} else if (folder == "48h-geneve") {
  images = import.meta.glob(
    "../../assets/48h-geneve/*.{avif,png,jpg,jpeg,svg,JPEG}",
  );
} else if (folder == "lamia") {
  images = import.meta.glob(
    "../../assets/lamia/*.{avif,png,jpg,jpeg,svg,JPEG}",
  );
}

// Charger les images
const loadedImages = await Promise.all(
  Object.entries(images).map(async ([path, resolver]) => {
    const mod = await (resolver as any)();
    return { src: mod.default, ...mod };
  }),
);
---

<style>
  .image-gallery {
    column-count: 3;
    column-gap: 10px;
  }

  figure {
    margin: 0;
    display: grid;
    grid-template-rows: auto;
    margin-bottom: 10px;
    break-inside: avoid;
  }

  figure > img {
    width: 100%;
    display: block;
  }

  @media (max-width: 1200px) {
    .image-gallery {
      column-count: 3;
    }
  }

  @media (max-width: 768px) {
    .image-gallery {
      column-count: 2;
    }
  }

  @media (max-width: 480px) {
    .image-gallery {
      column-count: 1;
    }
  }
</style>

<div class="image-gallery">
  {
    loadedImages.map((image, index) => (
      <figure>
        <Picture
          src={image.src}
          widths={[400, 800]}
          sizes="(max-width: 768px) 100vw, 33vw"
          formats={["avif", "webp"]}
          alt={`Gallery image ${index + 1}`}
          class="rounded-xl shadow-md hover:shadow-xl transition-all duration-300 hover:scale-[1.02] cursor-pointer object-cover w-full h-64"
          data-gallery-image
        />
      </figure>
    ))
  }
</div>
```

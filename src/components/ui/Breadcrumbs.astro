---
import { Icon } from "astro-icon/components";
import { safeJson } from "../../utils/security";

interface Props {
  items: {
    label: string;
    href?: string;
  }[];
}

const { items } = Astro.props;

// Schema.org Structured Data
const schema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  itemListElement: items.map((item, index) => ({
    "@type": "ListItem",
    position: index + 1,
    name: item.label,
    item: item.href ? new URL(item.href, Astro.url).href : undefined,
  })),
};
---

<nav
  aria-label="Fil d'Ariane"
  class="mb-8 font-outfit"
  style="contain: layout;"
>
  <ol
    class="flex items-center flex-wrap gap-2 text-sm text-pacamara-primary/60 dark:text-white/60"
  >
    {
      items.map((item, index) => {
        const isLast = index === items.length - 1;

        return (
          <li class="flex items-center gap-2">
            {index > 0 && (
              <Icon
                name="mdi:chevron-right"
                class="w-4 h-4 text-pacamara-primary/50 dark:text-white/50"
                aria-hidden="true"
              />
            )}

            {isLast ? (
              <span
                class="text-pacamara-primary dark:text-white font-medium truncate max-w-[200px] md:max-w-xs"
                aria-current="page"
                title={item.label}
              >
                {item.label}
              </span>
            ) : (
              <a
                href={item.href}
                class="hover:text-pacamara-accent focus-visible:text-pacamara-accent transition-colors capitalize focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-pacamara-accent focus-visible:ring-offset-2 rounded-md p-1.5 -m-1.5"
              >
                {item.label}
              </a>
            )}
          </li>
        );
      })
    }
  </ol>
</nav>

<script type="application/ld+json" is:inline set:html={safeJson(schema)} />

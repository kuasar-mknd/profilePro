---
const { title, category } = Astro.props;

const tagTranslations = {
  "behind-the-scenes": "Coulisses",
  photo: "Photographie",
  video: "Vidéo",
  general: "Général",
  music: "Musique",
  concert: "Concert",
};

const displayCategory = category
  ? tagTranslations[category] || category.replace(/-/g, " ")
  : "";

const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  itemListElement: [
    {
      "@type": "ListItem",
      position: 1,
      name: "Accueil",
      item: new URL("/", Astro.url).toString(),
    },
    {
      "@type": "ListItem",
      position: 2,
      name: "Projets",
      item: new URL("/project", Astro.url).toString(),
    },
    ...(category
      ? [
          {
            "@type": "ListItem",
            position: 3,
            name: displayCategory,
            item: new URL(`/project/tag/${category}`, Astro.url).toString(),
          },
        ]
      : []),
    {
      "@type": "ListItem",
      position: category ? 4 : 3,
      name: title,
      item: Astro.url.toString(),
    },
  ],
};
---

<script
  type="application/ld+json"
  set:html={JSON.stringify(breadcrumbSchema)}
/>

<nav
  aria-label="Breadcrumb"
  class="mb-8 animate-fade-in opacity-0"
  style="animation-delay: 0.1s;"
>
  <ol
    class="flex items-center space-x-2 text-pacamara-primary dark:text-white list-none pl-0"
  >
    <li>
      <a href="/" class="hover:text-pacamara-accent transition-colors"
        >Accueil</a
      >
    </li>
    <li>
      <span class="opacity-50" aria-hidden="true">/</span>
    </li>
    <li>
      <a href="/project" class="hover:text-pacamara-accent transition-colors"
        >Projets</a
      >
    </li>
    {
      category && (
        <>
          <li>
            <span class="opacity-50">/</span>
          </li>
          <li>
            <a
              href={`/project/tag/${category}`}
              class="hover:text-pacamara-accent transition-colors capitalize"
            >
              {displayCategory}
            </a>
          </li>
        </>
      )
    }
    <li>
      <span class="opacity-50" aria-hidden="true">/</span>
    </li>
    <li
      class="text-pacamara-primary dark:text-white font-medium truncate max-w-[200px] md:max-w-none"
      aria-current="page"
    >
      {title}
    </li>
  </ol>
</nav>
